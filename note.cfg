1. add low quality filter to bwa-mem2
2. divide the genome into equivalent regions and output alignment results to different files according to alignment positions
3. sort, markdup, var calling independently on each region

  [Raw Fastq] -> <BWA-MEM2>

[todo]
	1. As for now, ebam_set_reset() and ebam_set_dump() were put in step 1, which is not so efficient.
	   ebam_set_reset() -> step 0
		 ebam_set_dump()  -> step 2
	2. only pair end mapping now

[week notes] 3.17-3.21
	1. In Bwa, 3 is used for representing SOFTCLIP, while 4 is used in Samtools;
	2. The segment 'l_data' in structure 'bam1_t' was not assigned to proper value;
	3. The storage of secondary/supplimentary alignment was not properly addressed;

[jb]
	ssh phoenix@172.16.25.153
	gpudev@
	/mnt/yangjiaobo_mix/WGS/20200420

[v1.1.1]

	[personal_pe100 50x]
		[IPC1]
//		0.5x WGS IPC1 40 threads
//			std
//				filter and alignment cost: 314s
//				sort and markdup cost:     503s
//			acc
//				filter and alignment cost: 192s
//				sort and markdup cost:     255s
//			
//		5x WGS IPC1 40 threads
//			std
//				filter and alignment cost: 2326s
//				sort and markdup cost:     3800s
//			acc
//				filter and alignment cost: 1099s
//				sort and markdup cost:     2019s
		
		5x WGS IPC1 20 threads
			std
				filter and alignment cost: s
				sort and markdup cost:     s
			acc
				filter and alignment cost: 1259s
				sort and markdup cost:     268s
		
		[IPC2]
//			[PE100 WGS 50x, E5-2650V4 x 2, use 48 Threads]
//			STD
//				Filter and alignment cost: 9.09h
//				Sort and markdup cost:     17.75h
//
//			ACC [AVX2, Previous Version]
//				Filter and alignment cost: 2.81h
//				Sort and markdup cost:     7.02h

			[PE100 WGS 50x, E5-2650V4 x 2, use 24 Threads]
			STD
				SOAPnuke begins at 2020年 04月 30日 星期四 11:37:43 CST
				SOAPnuke ends at 2020年 04月 30日 星期四 12:12:21 CST

				Alignment begins at 2020年 04月 30日 星期四 12:12:21 CST
				Alignment ends at 2020年 04月 30日 星期四 20:23:18 CST

				// 6827 s
				Alignment sort beins at 2020年 04月 30日 星期四 20:23:18 CST
				Alignment sort ends at 2020年 04月 30日 星期四 22:17:05 CST

				Merge bams begins at 2020年 04月 30日 星期四 22:17:05 CST
				Merge bams ends at 2020年 05月 01日 星期五 01:44:12 CST

				Mark PCR Duplicates begins at 2020年 05月 01日 星期五 01:44:12 CST
				Mark PCR Duplicates ends at 2020年 05月 01日 星期五 07:13:09 CST

				Final merge and build index begins at: 2020年 05月 01日 星期五 07:13:09 CST
				Final merge and build index ends at: 2020年 05月 01日 星期五 13:41:23 CST

				Filter and alignment cost: 31535s (8.76h)
				Sort and markdup cost:     38991s (10.83h) excluding building index
				                           62285s (17.30h) including building index

			STD multi thread samtools merge and index
				// 1456 s
				Merge bams begins at 2020年 05月 08日 星期五 12:09:43 CST
				Merge bams ends at 2020年 05月 08日 星期五 12:33:59 CST

				// 19514 s
				Mark PCR Duplicates begins at 2020年 05月 08日 星期五 12:33:59 CST
				Mark PCR Duplicates ends at 2020年 05月 08日 星期五 17:59:13 CST

				// 2348 s
				Final merge begins at: 2020年 05月 13日 星期三 15:47:42 CST
				Final merge ends at: 2020年 05月 13日 星期三 16:26:50 CST

				// 150 s
				Build index begins at: 2020年 05月 13日 星期三 16:26:50 CST
				Build index ends at: 2020年 05月 13日 星期三 16:29:20 CST

				Filter and alignment cost: 31535s (8.76h)
				Sort and markdup cost:     30295s (8.42h)


			ACC [AVX2]
				Alignment costs 12313s
				Sort and markdup costs 8747s 
				Remove temporary files costs 42s

			[PE100 WGS 50x, E5-2650V4 x 2, use 24 Threads]
			STD
				Filter and alignment cost: 8.76h
				Sort and markdup cost:     8.42h
				Total cost:                17.18h

			ACC [AVX2]
				Filter and alignment cost: 3.42h (2.56x)
				Sort and markdup cost:     2.43h (3.46x)
				Total cost:                5.85h (2.94x)

		[tj node]
			acc
				filter and alignment cost: 16372s
				sort and markdup cost:     15483s
	
	[na12878_pe150]
//		[IPC2]
//			[std]
//			SOAPnuke begins at 2020年 04月 15日 星期三 10:29:39 CST
//			SOAPnuke ends at 2020年 04月 15日 星期三 11:26:10 CST
//
//			Alignment begins at 2020年 04月 15日 星期三 11:26:10 CST
//			Alignment ends at 2020年 04月 15日 星期三 17:28:31 CST
//
//			Alignment sort beins at 2020年 04月 15日 星期三 17:28:31 CST
//			Alignment sort ends at 2020年 04月 15日 星期三 19:17:55 CST
//
//			Mark PCR Duplicates begins at 2020年 04月 15日 星期三 23:19:21 CST
//			Mark PCR Duplicates ends at 2020年 04月 16日 星期四 05:27:01 CST
//
//			Final merge and build index begins at: 2020年 04月 16日 星期四 05:27:01 CST
//			Final merge and build index ends at: 2020年 04月 16日 星期四 05:43:09 CST
//
//			[std vs acc]
//			std
//				filter and alignment cost: 6.98h
//
//			acc
//				filter and alignment cost: 7180s[6837s] (x)
		[IPC2 24th]
			[std]
			SOAPnuke begins at 2020年 04月 28日 星期二 17:46:13 CST
			SOAPnuke ends at 2020年 04月 28日 星期二 18:43:28 CST

			Alignment begins at 2020年 04月 28日 星期二 18:43:28 CST
			Alignment ends at 2020年 04月 29日 星期三 00:22:00 CST

			Alignment sort beins at 2020年 04月 29日 星期三 00:22:00 CST
			Alignment sort ends at 2020年 04月 29日 星期三 02:06:14 CST

			Mark PCR Duplicates begins at 2020年 04月 29日 星期三 02:06:14 CST
			Mark PCR Duplicates ends at 2020年 04月 29日 星期三 07:54:38 CST

			Final merge and build index begins at: 2020年 04月 29日 星期三 07:54:38 CST
			Final merge and build index ends at: 2020年 04月 29日 星期三 08:10:44 CST

			[std v.s. acc]
			std
				filter and alignment cost: 23747s
				sort and markdup cost: 27158s

			acc
				filter and alignment cost: 9063s
				sort and markdup cost: 2030s

			[NA12878 PE150 20x, E5-2650V4 x 2, use 24 Threads]
			STD
				Filter and alignment cost: 6.60h
				Sort and markdup cost:     7.27h  (7.54h)
				Total cost:                13.87h (14.14h)

			ACC [AVX2]
				Filter and alignment cost: 2.52h (2.62x)
				Sort and markdup cost:     0.56h (13.38x)
				Total cost:                3.08h (4.59x)

//		[SZ Compter Cluster 48th]
//			sentieon.q@cngb-fpga-f5-9.cngb
//			[std]
//			SOAPnuke begins at Fri Apr 10 23:50:01 HKT 2020
//			SOAPnuke ends at Sat Apr 11 09:58:58 HKT 2020
//	
//			Alignment begins at Sat Apr 11 09:58:59 HKT 2020
//			Alignment ends at Mon Apr 13 18:12:07 HKT 2020
//	
//			Alignment sort beins at Mon Apr 13 18:12:07 HKT 2020
//			Alignment sort ends at Mon Apr 13 22:24:25 HKT 2020
//
//		[tj node]
//			acc
//				filter and alignment cost: 12962s
//				sort and markdup cost:     11312s


	[Summary] 2020.05.20

			[PE100 WGS 50x, E5-2650V4 x 2, use 24 Threads]
			STD
				Filter and alignment cost: 8.76h
				Sort and markdup cost:     8.42h
				Total cost:                17.18h

			ACC [AVX2]
				Filter and alignment cost: 3.42h (2.56x)
				Sort and markdup cost:     2.43h (3.46x)
				Total cost:                5.85h (2.94x)

			[NA12878 PE150 20x, E5-2650V4 x 2, use 24 Threads]
			STD
				Filter and alignment cost: 6.60h
				Sort and markdup cost:     7.27h  (7.54h)
				Total cost:                13.87h (14.14h)

			ACC [AVX2]
				Filter and alignment cost: 2.52h (2.62x)
				Sort and markdup cost:     0.56h (13.38x)
				Total cost:                3.08h (4.59x)



